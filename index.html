<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-sky color="#ECECEC"></a-sky>
      <a-entity environment="preset: starry;"></a-entity>

      <!-- Камера -->
      <a-camera position="0 1 0" wasd-controls="enabled: false"></a-camera>

      <!-- Контроллеры Pico 4 -->
      <a-entity 
        id="left-controller" 
        laser-controls="hand: left" 
        line="color: red; opacity: 0.5;" 
        position="0 1 0" 
        raycaster="objects: .clickable; far: 10">
      </a-entity>

      <a-entity 
        id="right-controller" 
        laser-controls="hand: right" 
        line="color: blue; opacity: 0.5;" 
        position="0 1 0" 
        raycaster="objects: .clickable; far: 10">
      </a-entity>

      <!-- Кнопка -->
      <a-entity position="0 1 -2">
        <a-plane 
          id="button" 
          class="clickable" 
          width="1" height="0.4" 
          color="#008CBA"
          hoverable
          clickable>
        </a-plane>
        <a-text value="Next Scene!" align="center" color="white" position="0 0 0.01"></a-text>
      </a-entity>

      <!-- Звук клика -->
      <a-assets>
        <audio id="click-sound" src="blip/blick_click.wav" preload="auto"></audio>
      </a-assets>

      <script>
        // Компонент для эффекта наведения
        AFRAME.registerComponent('hoverable', {
          init: function () {
            var el = this.el;
            el.addEventListener('mouseenter', function () {
              el.setAttribute('color', '#005F7F'); // Цвет при наведении
            });
            el.addEventListener('mouseleave', function () {
              el.setAttribute('color', '#008CBA'); // Исходный цвет
            });
          }
        });

        // Компонент для обработки кликов (переход на другую сцену)
        AFRAME.registerComponent('clickable', {
          init: function () {
            var el = this.el;
            el.addEventListener('click', function () {
              // Изменение цвета кнопки при клике
              el.setAttribute('color', '#FF5733'); // Цвет при клике

              // Переход на вторую сцену
              setTimeout(function() {
                window.location.href = "scene2.html"; // Переход на вторую сцену
              }, 500); // Переход после 500 мс, чтобы можно было увидеть изменение цвета
            });
          }
        });

        // Обработка нажатия триггера на контроллере
        function handleTriggerDown(event) {
          var intersection = event.detail.intersection;
          if (intersection && intersection.object.classList.contains('clickable')) {
            // Воспроизведение звука клика
            var sound = document.querySelector('#click-sound');
            if (sound) {
              sound.play();
            }

            // Эмуляция клика
            intersection.object.emit('click');
          }
        }

        document.querySelector('#left-controller').addEventListener('triggerdown', handleTriggerDown);
        document.querySelector('#right-controller').addEventListener('triggerdown', handleTriggerDown);
      </script>

    </a-scene>
  </body>
</html>
