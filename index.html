<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Элементы сцены с классом scene-entity -->
      <a-sky class="scene-entity" color="#ECECEC"></a-sky>
      <a-entity class="scene-entity" environment="preset: starry;"></a-entity>
      <a-entity class="scene-entity" position="0 1 -2">
        <a-plane 
          id="button" 
          class="clickable" 
          width="1" height="0.4" 
          color="#008CBA"
          hoverable
          clickable
          load-next-scene>
        </a-plane>
        <a-text value="Next" align="center" color="white" position="0 0 0.01"></a-text>
      </a-entity>

      <!-- Постоянные элементы -->
      <a-camera id="camera" position="0 1 0" wasd-controls="enabled: false"></a-camera>
      <a-entity 
        id="left-controller" 
        laser-controls="hand: left" 
        position="0 1 0" 
        raycaster="objects: .clickable; far: 10; lineColor: white; lineOpacity: 0.5"
        sound="src: #click-sound; on: click">
      </a-entity>
      <a-entity 
        id="right-controller" 
        laser-controls="hand: right" 
        position="0 1 0" 
        raycaster="objects: .clickable; far: 10; lineColor: white; lineOpacity: 0.5"
        sound="src: #click-sound; on: click">
      </a-entity>

      <!-- Ассеты -->
      <a-assets>
        <audio id="click-sound" src="sounds/blip/blick_click.wav"></audio>
      </a-assets>

      <!-- Скрипты -->
      <script>
        // Компонент для эффекта наведения
        AFRAME.registerComponent('hoverable', {
          init: function () {
            var el = this.el;
            el.addEventListener('mouseenter', function () {
              el.setAttribute('color', '#005F7F');
            });
            el.addEventListener('mouseleave', function () {
              el.setAttribute('color', '#008CBA');
            });
          }
        });

        // Компонент для перехода на следующую сцену
        AFRAME.registerComponent('load-next-scene', {
          init: function () {
            this.el.addEventListener('click', () => {
              fetch('scene1.html')
                .then(response => response.text())
                .then(text => {
                  const parser = new DOMParser();
                  const doc = parser.parseFromString(text, 'text/html');
                  const newEntities = doc.body.children;
                  const sceneEl = this.el.sceneEl;

                  // Удаляем старые элементы с классом scene-entity
                  Array.from(sceneEl.querySelectorAll('.scene-entity')).forEach(el => {
                    el.parentNode.removeChild(el);
                  });

                  // Добавляем новые элементы
                  Array.from(newEntities).forEach(entity => {
                    const importedEntity = document.importNode(entity, true);
                    sceneEl.appendChild(importedEntity);
                  });
                })
                .catch(error => console.error('Ошибка загрузки сцены:', error));
            });
          }
        });
      </script>
    </a-scene>
  </body>
</html>